import"./main-wURK7Rzl.js";import{s as r}from"./modal-DdRFM3Ou.js";let i=[];const d=localStorage.getItem("nome"),a=localStorage.getItem("turmaSelecionada");d&&(document.getElementById("nomeTreinador").textContent=d);a&&(document.getElementById("turmaSelecionada").textContent=a);async function h(){try{i=await(await fetch(`https://unifor-atletas.onrender.com/api/aluno/buscar?turma=${encodeURIComponent(a)}`)).json();const n=document.getElementById("lista-alunos");n.innerHTML='<h4 style="margin-top: 0; color: #142191;">Nome dos Alunos</h4>',i.forEach((o,t)=>{n.innerHTML+=`
         <div class="aluno-card">
         <span>${o.nome}</span>
         <span>
          <input type="radio" name="aluno${t}" value="presente">  Presente
          <input type="radio" name="aluno${t}" value="ausente">  Ausente
         </span>
       </div>`}),l()}catch(e){console.error("Erro ao carregar alunos:",e),r("Erro","Erro ao carregar lista de alunos.")}}async function g(){const e=document.getElementById("novoAlunoNome").value.trim();if(!e||!a)return r("Atenção","Nome e turma são obrigatórios.");try{const n=await fetch("https://unifor-atletas.onrender.com/api/aluno/cadastrar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nome:e,turma:a})}),o=await n.json();n.ok?(r("Sucesso","Aluno adicionado com sucesso!"),document.getElementById("novoAlunoNome").value="",h()):r("Erro",o.error||"Erro ao adicionar aluno.")}catch{r("Erro","Erro ao adicionar aluno.")}}async function f(){const e=document.getElementById("dataSelecionada").value;if(!e)return r("Atenção","Selecione uma data!");const n={};i.forEach((o,t)=>{const s=document.querySelector(`input[name=aluno${t}]:checked`);n[o.nome]=s?s.value:null});try{const t=await(await fetch("https://unifor-atletas.onrender.com/api/presenca/registrar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({turma:a,data:e,registros:n})})).json();r("Informação",t.message||"Presenças salvas!"),l()}catch(o){r("Erro","Erro ao salvar presença."),console.error(o)}}async function l(){const e=document.getElementById("historico");e.innerHTML="";try{const o=await(await fetch(`https://unifor-atletas.onrender.com/api/presenca/historico?turma=${encodeURIComponent(a)}`)).json();if(!o||Object.keys(o).length===0){e.innerHTML="<p>Nenhum histórico encontrado.</p>";return}i.forEach(t=>{const s=[],c=[];for(const[u,m]of Object.entries(o))m[t.nome]==="presente"?s.push(p(u)):m[t.nome]==="ausente"&&c.push(p(u));(s.length||c.length)&&(e.innerHTML+=`
        <details>
          <summary>${t.nome}</summary>
          <p><strong>Dias Presente:</strong> ${s.join(", ")||"Nenhum"}</p>
          <p><strong>Dias Ausente:</strong> ${c.join(", ")||"Nenhum"}</p>
        </details>`)})}catch{e.innerHTML="<p>Erro ao carregar histórico.</p>"}}function p(e){const[n,o,t]=e.split("-");return`${t}/${o}/${n}`}function y(){localStorage.clear(),window.location.href="loginTrein.html"}document.addEventListener("DOMContentLoaded",h);window.adicionarAluno=g;window.salvarPresencas=f;window.logout=y;window.carregarHistorico=l;
